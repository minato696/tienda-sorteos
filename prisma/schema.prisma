// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Participante {
  id           Int      @id @default(autoincrement())
  dni          String
  nombres      String
  apellidos    String
  telefono     String
  email        String
  departamento String
  cantidad     Int      @default(1)
  fechaRegistro DateTime @default(now())
  tickets      Ticket[]
  creadoEn     DateTime @default(now())
  sorteoId     Int?     // Añadimos la referencia al sorteo
  sorteo       Sorteo?  @relation(fields: [sorteoId], references: [id])
}

model Ticket {
  id             Int          @id @default(autoincrement())
  codigo         String       @unique
  participante   Participante @relation(fields: [participanteId], references: [id])
  participanteId Int
  createdAt      DateTime     @default(now())
  sorteoId       Int?         // Añadimos la referencia al sorteo
  sorteo         Sorteo?      @relation(fields: [sorteoId], references: [id])
}

// Modelo para Sorteos
model Sorteo {
  id                Int           @id @default(autoincrement())
  titulo            String
  descripcion       String
  imagenUrl         String        @default("/images/default-sorteo.jpg")
  precio            Float         // Precio en Soles Peruanos
  fechaSorteo       DateTime
  ticketsDisponibles Int
  ticketsVendidos   Int           @default(0)
  estado            String        @default("ACTIVO") // ACTIVO, FINALIZADO, CANCELADO
  premio            String
  valorPremio       Float?        // Valor del premio en Soles Peruanos
  destacado         Boolean       @default(false)
  createdAt         DateTime      @default(now())
  updatedAt         DateTime      @updatedAt
  participantes     Participante[]
  tickets           Ticket[]
}